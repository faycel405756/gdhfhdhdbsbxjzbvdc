# By AbdeeLkarim BesTo

import requests , json , binascii , time , urllib3 , base64 , datetime , re ,socket , threading , random , os , sys , psutil
from protobuf_decoder.protobuf_decoder import Parser
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad , unpad
from datetime import datetime
from google.protobuf.timestamp_pb2 import Timestamp
from random import choice







urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

Key , Iv = bytes([89, 103, 38, 116, 99, 37, 68, 69, 117, 104, 54, 37, 90, 99, 94, 56]) , bytes([54, 111, 121, 90, 68, 114, 50, 50, 69, 51, 121, 99, 104, 106, 77, 37])

def Ua():
    versions = [
        '4.0.18P6', '4.0.19P7', '4.0.20P1', '4.1.0P3', '4.1.5P2', '4.2.1P8',
        '4.2.3P1', '5.0.1B2', '5.0.2P4', '5.1.0P1', '5.2.0B1', '5.2.5P3',
        '5.3.0B1', '5.3.2P2', '5.4.0P1', '5.4.3B2', '5.5.0P1', '5.5.2P3'
    ]
    models = [
        'SM-A125F', 'SM-A225F', 'SM-A325M', 'SM-A515F', 'SM-A725F', 'SM-M215F', 'SM-M325FV',
        'Redmi 9A', 'Redmi 9C', 'POCO M3', 'POCO M4 Pro', 'RMX2185', 'RMX3085',
        'moto g(9) play', 'CPH2239', 'V2027', 'OnePlus Nord', 'ASUS_Z01QD',
    ]
    android_versions = ['9', '10', '11', '12', '13', '14']
    languages = ['en-US', 'es-MX', 'pt-BR', 'id-ID', 'ru-RU', 'hi-IN']
    countries = ['USA', 'MEX', 'BRA', 'IDN', 'RUS', 'IND']
    version = random.choice(versions)
    model = random.choice(models)
    android = random.choice(android_versions)
    lang = random.choice(languages)
    country = random.choice(countries)
    return f"GarenaMSDK/{version}({model};Android {android};{lang};{country};)"
    
def EnC_AEs(HeX):
    cipher = AES.new(Key , AES.MODE_CBC , Iv)
    return cipher.encrypt(pad(bytes.fromhex(HeX), AES.block_size)).hex()
def ArA_CoLor():
    Tp = ["32CD32" , "00BFFF" , "00FA9A" , "90EE90" , "FF4500" , "FF6347" , "FF69B4" , "FF8C00" , "FF6347" , "FFD700" , "FFDAB9" , "F0F0F0" , "F0E68C" , "D3D3D3" , "A9A9A9" , "D2691E" , "CD853F" , "BC8F8F" , "6A5ACD" , "483D8B" , "4682B4", "9370DB" , "C71585" , "FF8C00" , "FFA07A"]
    return random.choice(Tp) 
def generate_random_color():
    color_list = [
        "[FF69B4][b][i][c]",  # ÙˆØ±Ø¯ÙŠ ÙØ§Ù‚Ø¹
        "[006400][b][i][c]",  # Ø£Ø®Ø¶Ø± ØºØ§Ù…Ù‚
        "[FFDAB9][b][i][c]",  # Ø®ÙˆØ®ÙŠ
        "[4169E1][b][i][c]",  # Ø£Ø²Ø±Ù‚ Ù…Ù„ÙƒÙŠ
        "[FF0000][b][i][c]",  # Ø£Ø­Ù…Ø± ÙØ§Ù‚Ø¹
        "[90EE90][b][i][c]",  # Ø£Ø®Ø¶Ø± ÙØ§ØªØ­
        "[800080][b][i][c]",  # Ø¨Ù†ÙØ³Ø¬ÙŠ
        "[DC143C][b][i][c]",  # Ù‚Ø±Ù…Ø²ÙŠ
        "[FFD700][b][i][c]",  # Ø°Ù‡Ø¨ÙŠ
        "[ADFF2F][b][i][c]",  # Ø£ØµÙØ± Ù…Ø®Ø¶Ø±
        "[C71585][b][i][c]",  # Ø¨Ù†ÙØ³Ø¬ÙŠ ÙˆØ±Ø¯ÙŠ
        "[FF4500][b][i][c]",  # Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø£Ø­Ù…Ø±
        "[DA70D6][b][i][c]",  # Ø£Ø±Ø¬ÙˆØ§Ù†ÙŠ ÙØ§ØªØ­
        "[8B0000][b][i][c]",  # Ø£Ø­Ù…Ø± ØºØ§Ù…Ù‚
        "[32CD32][b][i][c]",  # Ø£Ø®Ø¶Ø± Ù„ÙŠÙ…ÙˆÙ†ÙŠ
        "[87CEEB][b][i][c]",  # Ø£Ø²Ø±Ù‚ Ø³Ù…Ø§ÙˆÙŠ
        "[DB7093][b][i][c]",  # ÙˆØ±Ø¯ÙŠ Ø¨Ø§Ù‡Øª
        "[FFA500][b][i][c]",  # Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
        "[4682B4][b][i][c]",  # Ø£Ø²Ø±Ù‚ ÙÙˆÙ„Ø§Ø°ÙŠ
        "[FFFACD][b][i][c]",  # Ø£ØµÙØ± ÙØ§ØªØ­
        "[00FF00][b][i][c]",  # Ø£Ø®Ø¶Ø± ÙØ§Ù‚Ø¹
        "[8A2BE2][b][i][c]",  # Ø¨Ù†ÙØ³Ø¬ÙŠ Ø£Ø²Ø±Ù‚
        "[FFA07A][b][i][c]",  # Ø³Ø§Ù„Ù…ÙˆÙ† ÙØ§ØªØ­
        "[D8BFD8][b][i][c]",  # Ø«ÙŠØ³Ù„
        "[FF6347][b][i][c]",  # Ø£Ø­Ù…Ø± Ø·Ù…Ø§Ø·Ù…
        "[FFB347][b][i][c]",  # Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ ÙØ§ØªØ­
        "[FF1493][b][i][c]",  # ÙˆØ±Ø¯ÙŠ Ø¹Ù…ÙŠÙ‚
        "[EEE8AA][b][i][c]",  # ÙƒØ§ÙƒÙŠ ÙØ§ØªØ­
        "[00008B][b][i][c]",  # Ø£Ø²Ø±Ù‚ ØºØ§Ù…Ù‚
        "[FFA500][b][i][c]",  # Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
        "[0000FF][b][i][c]",  # Ø£Ø²Ø±Ù‚ ÙØ§Ù‚Ø¹
        "[BA55D3][b][i][c]",  # Ø¨Ù†ÙØ³Ø¬ÙŠ Ù…ØªÙˆØ³Ø·
        "[FFDD00][b][i][c]",  # Ø£ØµÙØ± ÙØ§Ù‚Ø¹
        "[FFC0CB][b][i][c]",  # ÙˆØ±Ø¯ÙŠ
        "[FFA07A][b][i][c]"   # Ø³Ø§Ù„Ù…ÙˆÙ† ÙØ§ØªØ­
    ]
    random_color = random.choice(color_list)
    return random_color
def DEc_AEs(HeX):
    cipher = AES.new(Key , AES.MODE_CBC , Iv)
    return unpad(cipher.decrypt(bytes.fromhex(HeX)), AES.block_size).hex()
    
def EnC_PacKeT(HeX , K , V): 
    return AES.new(K , AES.MODE_CBC , V).encrypt(pad(bytes.fromhex(HeX) ,16)).hex()
    
def DEc_PacKeT(HeX , K , V):
    return unpad(AES.new(K , AES.MODE_CBC , V).decrypt(bytes.fromhex(HeX)) , 16).hex()  



def random_channel():
    channel = random.choice(['en','ar','ar','br'])

    return channel




def EnC_Uid(H , Tp):
    e , H = [] , int(H)
    while H:
        e.append((H & 0x7F) | (0x80 if H > 0x7F else 0)) ; H >>= 7
    return bytes(e).hex() if Tp == 'Uid' else None

def EnC_Vr(N):
    if N < 0: ''
    H = []
    while True:
        BesTo = N & 0x7F ; N >>= 7
        if N: BesTo |= 0x80
        H.append(BesTo)
        if not N: break
    return bytes(H)
    
def DEc_Uid(H):
    n = s = 0
    for b in bytes.fromhex(H):
        n |= (b & 0x7F) << s
        if not b & 0x80: break
        s += 7
    return n
    
def CrEaTe_VarianT(field_number, value):
    field_header = (field_number << 3) | 0
    return EnC_Vr(field_header) + EnC_Vr(value)

def CrEaTe_LenGTh(field_number, value):
    field_header = (field_number << 3) | 2
    encoded_value = value.encode() if isinstance(value, str) else value
    return EnC_Vr(field_header) + EnC_Vr(len(encoded_value)) + encoded_value

def CrEaTe_ProTo(fields):
    packet = bytearray()    
    for field, value in fields.items():
        if isinstance(value, dict):
            nested_packet = CrEaTe_ProTo(value)
            packet.extend(CrEaTe_LenGTh(field, nested_packet))
        elif isinstance(value, int):
            packet.extend(CrEaTe_VarianT(field, value))           
        elif isinstance(value, str) or isinstance(value, bytes):
            packet.extend(CrEaTe_LenGTh(field, value))           
    return packet    
    
def get_random_banner_id():
    banner_list = [827001007, 804605801, 827001002, 827001008, 827001009]
    return random.choice(banner_list)
def DecodE_HeX(H):
    R = hex(H) 
    F = str(R)[2:]
    if len(F) == 1: F = "0" + F ; return F
    else: return F

def Fix_PackEt(parsed_results):
    result_dict = {}
    for result in parsed_results:
        field_data = {}
        field_data['wire_type'] = result.wire_type
        if result.wire_type == "varint":
            field_data['data'] = result.data
        if result.wire_type == "string":
            field_data['data'] = result.data
        if result.wire_type == "bytes":
            field_data['data'] = result.data
        elif result.wire_type == 'length_delimited':
            field_data["data"] = Fix_PackEt(result.data.results)
        result_dict[result.field] = field_data
    return result_dict

def DeCode_PackEt(input_text):
    try:
        parsed_results = Parser().parse(input_text)
        parsed_results_objects = parsed_results
        parsed_results_dict = Fix_PackEt(parsed_results_objects)
        json_data = json.dumps(parsed_results_dict)
        return json_data
    except Exception as e:
        print(f"error {e}")
        return None

def badge_generator():
    bAdge_list = ['32768', '32768', '1048576', '1048576', '2048', '2048', '262144', '262144']
    while True:
        for item in bAdge_list:
            yield int(item)

# Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆÙ„Ø¯ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
bAdge_gen = badge_generator()

def bAdge():
    return next(bAdge_gen)


# Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ø±ØªÙŠÙ† Ù…ØªØªØ§Ù„ÙŠØªÙŠÙ†
first_badge = bAdge()
second_badge = bAdge()

print(first_badge, second_badge)
def xBunnEr():
        avatar_list = [
            
            '902051003', '902000017', '902000306', '902047016', '902051034'
        ]
        return int(random.choice(avatar_list))
        
def GLobaL(T , K , V):
    fields =  {1: 3 , 2: {2: 5 , 3: f"ar"}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '1215' , K , V)

def ChaT_sQ(T , N , U , sQ , K , V):
    fields =  {1: N , 2: {1: int(U) , 3: f"{T}" , 4: str(sQ)}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '1215' , K , V)

def Send_MsG(msg , owner , K , V):
    fields = {
    1: 1,
    2: 2,
    2: {
        1: 0000000,
        2: owner,
        4: msg,
        5: 1757799182,
        7: 2,
        9: {
            1: "xBe4sTo",
            2: xBunnEr(),
            3: 909000024,
            4: 330,
            5: 909000024,
            7: 2,
            10: 1,
            11: 1,
            12: 0,
            13: {1: 2},
            14: {
                1: "FUCKING",
                2: 8,
                3: "\u0010\u0015\b\n\u000b\u0013\f\u000f\u0011\u0004\u0007\u0002\u0003\r\u000e\u0012\u0001\u0005\u0006"
            }
        },
        10: "ar",
        13: {3: 1},
        14: ""}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '1215' , K , V)
    
def Join_Sq(T , U , rQ , K , V):
    fields = {1: 4 , 2: {1: U , 6: 1 , 8: 1 , 13: f"{T}", 15: str(rQ) , 16: "OR"}} 
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '0515' , K , V)
    
def LeVe_C(cid , K , V):
  fields = {}
  fields[1] = 4
  fields[2] = {}
  fields[2][1] = int(cid)
  fields[2][2] = 5
  return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '1201' , K , V)
  
def Send_GhosTs(Uid , sQ , K , V):
    fields =  {1: 61 , 2: {1: 14075888491 , 2: {1: 14075888491 , 2: 1159, 3: f'[ff0030][b][i][c]ï¼©ï¼®ï¼³ï¼´ï¼¡: {generate_random_color()}@ï½‚ï½˜ï½Œï¼’_ï¼˜', 5: 12, 6: 999999999, 7: 3, 8: {2: 1, 3: 1}, 9: 6}, 3: '1771870670827056853_dfisb01tcn'}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '0515' , K , V)
    
def Send_InV(N , U , K , V):
    fields =  {1: 2 , 2: {1: int(U) , 2: "ME" , 4: N}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '0515' , K , V)


def Join_Sq(T , U , rQ , K , V):
    fields = {
 1: 4,
 2: {
     1: U,
     10: rQ,
     11: [
         {1: 'IDC1', 2: 91, 3: 'ME'},
         {1: 'IDC2', 2: 73, 3: 'ME'},
         {1: 'IDC3', 2: 187, 3: 'ME'},
         {1: 'IDC4', 2: 175, 3: 'ME'}
     ],
     13: 'ar',
     16: {},
     20: [
         {1: 3, 2: 391},
         {1: 4, 2: 385},
         {1: 5, 2: 192},
         {1: 29, 2: 204},
         {1: 22, 2: 115},
         {1: 14, 2: 175},
         {1: 21}
     ],
     23: 'a_2093076631814511175',
     4: {0: {}},
     6: 7,
     8: 1,
     9: {
         1: '08F9A33C340D9080020305011111000100590003005500097A16729C1089398C41713114110103014451bd3dcbfa97ee695e6680000000ff00010101cacfa16d',
         10: 2,
         2: 26,
         3: 'uX\\W\x10\x08\x02O\x03W\x06\x01\x08\t\x00\n\x0cP\x06\x03\x05SRR\x01\x02\x01Z\x06\x0b\x08\x06\x07\x06T\x01\x01\x02\x08\x06\x10\x00\x07Kv\\@FJ\x11\x02\x1f\x00\x1f\x14\x02\x03L^P\x0f\x00`rftcbT`fN\\Av\x7f^}P\x08fPZ\x06\x03\x0c\x15\x06OYsc`S\x02\x18~\x07\x05EC{\x04\x01P}\x03UcRQ~J}Jl\x0f\x10WYYG\x1ecz\x1e~BC\x03JX\x06~\x00\\\x07`Xv\x08\x19r_]VC\x00_b`\x04stQ\x03w\x06\x0e\x1a\x03\x00M\\RIEsB[Q\x1dp~YQpaq\x1d[zs\x18BLPwDy\x0f\x10\x01NbGQXARb~W~aBHwz\x04YrJfOU\x00eA\\\x03\x0c\x13\x00OTF\x07HEzUVesCux^i~]\x06\x7fGai{[{tU\n\x10\x08Lp|VHe@tE\x01}I\x19R~\x00@dzoP[\x08YuIB~\x0c\x15\x06\x0bMAwR]jCfdnx\x07_W\x1cLY_DC\x0fGK^J\x18PU\x0e\x12\x05Kk\x7fbtwN\x07[H[zK\x02^XwOdT\x1aN@\x07][H\x0b\x04\x11\x07MxObV}@x\x00^\x07_\x0fExxe`\x00A{F\x7fSXTKS\x0f\x10\x0b\x02O]\x04c\x04rFHPPZ\x18Cb\x06ZHhFDL}\x0b\x06\\qRZ\r\x11\x06EQ[eoyf\\\x03ku|zCsR}AfX@]PZfHev\x0e',
         4: '\x7fYYV',
         6: 12,
         7: {},
         8: '1.120.21',
         9: 3
     }
 }
}

    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '0515' , K , V)

def trydecByRedZed(pack):

    try:
       
    
        r = pack['5']['data']['31']['data']
    except:
        return None
    return r


def RedZed_3alamyia_Chat(uid, code , K, I):
    fields = {
  1: 3,
  2: {
    1: uid,
    3: "ar",
    4: str(code)
  }
}

    redzed_fields = str(CrEaTe_ProTo(fields).hex())
    return GeneRaTePk(str(redzed_fields) ,'1215', K, I)


def quit_caht_redzed(uid,K,I):
    fields = {
  1: 4,
  2: {
    1: uid,
    3: "ar"
  }
}
    redzed_fields = str(CrEaTe_ProTo(fields).hex())
    return GeneRaTePk(str(redzed_fields) ,'1215', K, I)


def RedZed_SendInv(bot_uid, uid,K,V):
    fields = {1: 33, 2: {1: int(uid), 2: "ME", 3: 1, 4: 1, 6: "RedZedKing!!", 7: 330, 8: 1000, 9: 100, 10: "DZ", 12: 1, 13: int(uid), 16: 1, 17: {2: 159, 4: "y[WW", 6: 11, 8: "1.118.1", 9: 3, 10: 1}, 18: 306, 19: 18, 24: 902000306, 26: {}, 27: {1: 11, 2: int(bot_uid), 3: 999}, 28: {}, 31: {1: 1, 2: bAdge()}, 32: bAdge(), 34: {1: bot_uid, 2: 8, 3: "\u0010\u0015\b\n\u000b\u0013\f\u000f\u0011\u0004\u0007\u0002\u0003\r\u000e\u0012\u0001\u0005\u0006"}}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '0515' , K , V)


import time

def RedZed_SendMsg(msg , owner , bot, K, I):
    fields = {
    1: 1,
    2: {
        1: bot,
        2: owner,
        4: msg,
        5: str(time.time()).split('.')[0],
        7: 2,
        9: {
            1: "VaizSá»‘2Gayy",
                2: xBunnEr(),
                3: 901037021,#int(get_random_banner()),
                4: random.randint(301,330),
                5: get_random_banner_id(),
                8: "á´…á´‡á´ á´‡ÊŸá´á´˜á´‡Ê€",
                10: 2,
                11: 2010, #Sá»‘ 2 TÆ°Æ¡ng á»¨ng Vá»›i Danh Hiá»‡u Top 2 Khu Vá»±c Sinh Tá»“n
                12: 100,
                13: {
                    1: 2,
                    2: 1,
                },
                14: {
                    1: 11017917409,
                    2: 8,
                    3: "\u0010\u0015\b\n\u000b\u0013\f\u000f\u0011\u0004\u0007\u0002\u0003\r\u000e\u0012\u0001\u0005\u0006", 
                    4: 2,
                    5: 8,
                }
            },
            10: "ar",
            12: 2,
            13: {
                1: "https://graph.facebook.com/v9.0/253082355523299/picture?width=160&height=160",
                2: 1,
                3: 1
            },
            14: {
                1: {
                    1: random.choice([1, 4]),
                    2: 1, #Sá»‘ 1 LÃ  Danh Hiá»‡u Top Viá»‡t Nam - CÃ¡c Sá»‘ Tá»« 2 Trá»Ÿ LÃªn LÃ  CÃ¡c Tá»‰nh ThÃ nh Top SÃºng
                    3: random.randint(1, 180), #Random Danh Hiá»‡u SÃºng
                    4: 1, #Sá»‘ 1 TÆ°Æ¡ng á»¨ng Vá»›i Top 1 Cá»§a Top SÃºng
                    5: int(datetime.now().timestamp()),
                    6: "VN" #Khu Vá»±c
                }
            }, 
            15: 3
        }
        }
    redzed_fields = str(CrEaTe_ProTo(fields).hex())
    return GeneRaTePk(str(redzed_fields) ,'1215', K, I)

def ExiT(K , V):
    fields = {1: 7 , 2: {1: int(00000000)}}
    return GeneRaTePk(str(CrEaTe_ProTo(fields).hex()) , '0515' , K , V)
                           
def GeneRaTePk(Pk , N , K , V):
    PkEnc = EnC_PacKeT(Pk , K , V)
    _ = DecodE_HeX(int(len(PkEnc) // 2))
    if len(_) == 2: HeadEr = N + "000000"
    elif len(_) == 3: HeadEr = N + "00000"
    elif len(_) == 4: HeadEr = N + "0000"
    elif len(_) == 5: HeadEr = N + "000"
    return bytes.fromhex(HeadEr + _ + PkEnc)
        
def ResTarTinG():
    print('\n - ResTartinG BoT ... ! ')
    try:
        p = psutil.Process(os.getpid())
        for f in p.open_files():
            try: os.close(f.fd)
            except: pass
        for conn in p.net_connections(kind='inet'):
            try:
                if conn.fd != -1: os.close(conn.fd)
            except: pass
    except: pass
    time.sleep(0.5)
    python = sys.executable
    os.execl(python, python, *sys.argv)
    
def AuTo_ResTartinG():
    time.sleep(24 * 60 * 60) # Ø²Ø¯Øª Ø§Ù„Ù…Ø¯Ø© Ù„ÙŠÙˆÙ… ÙƒØ§Ù…Ù„ Ø¨Ø¯Ù„ 6 Ø³Ø§Ø¹Ø§Øª
    print('\n - AuTo ResTartinG The BoT ... ! ')
    try:
        p = psutil.Process(os.getpid())
        for f in p.open_files():
            try:
                os.close(f.fd)
            except Exception as e:
                print(f" - Error Close File: {e}")
        for conn in p.net_connections(kind='inet'):
            try:
                if conn.fd != -1:
                    os.close(conn.fd)
            except Exception as e:
                print(f" - Error Close Connection: {e}")
    except Exception as e:
        print(f" - Error Accessing Process Info: {e}")

    python = sys.executable
    os.execl(python, python, *sys.argv)    
    
def GeT_Time(timestamp):
    last_login = datetime.fromtimestamp(timestamp)
    now = datetime.now()
    diff = now - last_login   
    h , rem = divmod(diff.seconds, 3600)
    m , s = divmod(rem, 60)    
    return h, m, s             
def xMsGFixinG(n):
    return 'ðŸ—¿'.join(str(n)[i:i + 1] for i in range(0 , len(str(n)) , 1))
def LogOuT(A):
    R = requests.Session().get(f'https://100067.connect.garena.com/oauth/logout?access_token={A}&refresh_token=')
    print(' - LoGOuT => ' , R.text)
    if R.status_code == 200 and '0' in R.text: return True
    else: return False